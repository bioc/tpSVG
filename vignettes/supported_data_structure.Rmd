---
title: "Working with different data objects"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Working with different data objects}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
  
```{r, include = FALSE}
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
message = FALSE
)
```

## image-based SRT in `SpatialExperiment` (e.g. `SpatialFeatureExperiment`)
`tpSVG` can be also used to model image-based SRT data. We use
the seqFISH data from [Lohoff and Ghazanfar _et al_. (2020)](https://www.nature.com/articles/s41587-021-01006-2) to demonstrate `tpSVG`. Specifically, we use the curated example data in [`STexampleData`](https://bioconductor.org/packages/release/data/experiment/html/STexampleData.html) package. For more information, please see the vignettes of [`STexampleData`](https://bioconductor.org/packages/release/data/experiment/vignettes/STexampleData/inst/doc/STexampleData_overview.html)

```{r load_seqFISH}
library(STexampleData)
spe <- seqFISH_mouseEmbryo()

spe
```

The example data set contains `351` genes for `11026` genes. To make the
demonstration computationally feasible, we down-size the number of genes to 1. 
The average computation times for 11026 cells is roughly 2 minutes.


```{r model_seqFISH}
# Calculate "library size"
spe$total <- counts(spe) |> colSums()

# Down-size genes
idx_gene <- which(
  rowData(spe)$gene_name %in%
    c("Sox2")
  )

library(tpSVG)

# Poisson model
tp_spe <- tpSVG(
  input = spe[idx_gene,],
  family = poisson(),
  offset = log(spe$total),
  assay_name = "counts")

rowData(tp_spe)
```

### Session Information
```{r sess_info}
sessioninfo::session_info()
```
